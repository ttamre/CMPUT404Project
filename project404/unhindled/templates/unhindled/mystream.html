<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <title>Unhindled</title>
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'unhindled/style.css' %}" />
    </head>
    <body>
      <main>
        <div class="home-page">
          {% if user.is_authenticated %}
          <div class="user-info">
            Hi {{ user.username }}!
            <a class="ml-2" href="{% url 'index' %}">Home</a>
            <a class="ml-2" href="{% url 'createPost' %}">Create Post Button</a>
            <div class="account-management">
                <a href="{% url 'profile' user.profile.pk %}">Profile</a>
                <a href="{% url 'account' %}">Manage Account</a>
                <a href="{% url 'logout' %}">Log Out</a>
            </div>
        </div>
            <h2>My Stream</h2>

            <h3>My Posts</h3>
            {% if object_list %}
              {% for post in object_list %}
                <!-- change this to ID when author and user are matched -->
                {% if post.author.displayName == user.username %}
                  <div class="post">
                      <a href="{% url 'viewPost' post.author.displayName post.pk %}">{{ post.title }}</a> <br>
                      By: {{ post.author }} <br>
                      {{ post.content }}
                  </div>
                  <hr>
                {% endif %}
              {% endfor %}
              <h3>Sent to me</h3>
              {% for post in object_list %}
                {% if post.send_to.displayName == user.username and post.visibility == "send" %}
                  <div class="post">
                      <a href="{% url 'viewPost' post.author.displayName post.pk %}">{{ post.title }}</a> <br>
                      By: {{ post.author }} <br>
                      {{ post.content }}
                  </div>
                  <hr>
                {% endif %}
              {% endfor %}
            {% else %}
                <p>No Posts to show.</p>
            {% endif %}
          {% endif %}

          <h3>My Activity</h3>
          {% if event_list %}
              <ul>
              {% for event in event_list %}
                  <li>{{ event }}</a></li>
              {% endfor %}
              </ul>
          {% else %}
              <p>No activity to show.</p>
          {% endif %}

          <!-- script>
            fetch("https://api.github.com/users/ttamre/events/public")
              .then(function (response) {
                document.getElementById("activity").innerHTML = response.json();
              })
              .catch(function (error) {
                document.getElementById("activity").innerHTML = "Error: " + error;
              });
          </script>

          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js">
            $(document).ready(function() {
              const Url = "https://api.github.com/users/ttamre/events/public";
              $('.btn').click(function() {
                  $.ajax({
                    url: Url,
                    type: "GET",
                    success: function(result) {
                      document.getElementById("activity").innerHTML = result
                    },
                    error:function(error) {
                      document.getElementById("activity").innerHTML = error
                  }
                })
              })
            })
          </script>

          <p id="activity"></p-->

        </div>
    </main>
  </body>
</html>
